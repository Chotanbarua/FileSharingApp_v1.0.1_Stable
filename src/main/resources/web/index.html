<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>File Sharing App</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f5f7fb; margin: 0; }
        .wrapper { max-width: 800px; margin: 20px auto; background: #fff; padding: 20px;
          border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
        h1 { margin-top: 0; color: #1f6feb; }
        label { display: block; margin-top: 10px; font-weight: bold; }
        input, select { width: 100%; padding: 8px; margin-top: 4px; border-radius: 5px; border: 1px solid #ccc; }
        button { margin-top: 15px; padding: 10px 16px; background: #1f6feb; color: #fff;
          border: none; border-radius: 6px; cursor: pointer; font-size: 15px; }
        button:hover { background: #144a9b; }
        .small { font-size: 12px; color: #666; }
        .ip-box { padding: 8px; background: #f0f4ff; border-radius: 6px; margin-bottom: 10px; }
    </style>
</head>
<body>
<div class="wrapper">
    <h1 tabindex="0">üìÅ File Sharing App - Web UI</h1>

    <div class="ip-box">
        <div>Your IP (share this with your partner): <span id="userIP">localhost</span></div>
        <div class="small">If you're on same Wi-Fi, use this. For remote, use ZeroTier.</div>
    </div>

    <label for="name">Your Name</label>
    <input id="name" type="text" placeholder="Enter your name" />

    <label for="role">Role</label>
    <select id="role">
        <option value="Sender">Sender</option>
        <option value="Receiver">Receiver</option>
    </select>

    <label for="method">Transfer Method</label>
    <select id="method">
        <option value="HTTP">HTTP (Simple / LAN)</option>
        <option value="ZeroTier">ZeroTier (Secure P2P)</option>
        <option value="S3">AWS S3 (Cloud)</option>
    </select>

    <label for="file">File (Sender only)</label>
    <input id="file" type="file" />

    <label for="target">Target IP / URL / Bucket</label>
    <input id="target" type="text" placeholder="192.168.x.x or bucket-name" />

    <label for="port">Port</label>
    <input id="port" type="text" value="8080" />

    <button id="startBtn">üöÄ Start</button>
    <div id="msg" class="small" aria-live="polite"></div>
</div>

<script>
    // Detect local IP (best effort)
    (function () {
      const ipField = document.getElementById('ipField');
      try {
        const pc = new RTCPeerConnection({iceServers: []});
        pc.createDataChannel("");
        pc.createOffer().then(o => pc.setLocalDescription(o));
        pc.onicecandidate = e => {
          if (!e || !e.candidate) return;
          const m = e.candidate.candidate.match(/([0-9]{1,3}(\.[0-9]{1,3}){3})/);
          if (m) {
            ipField.textContent = m[1];
            pc.close();
          }
        };
        setTimeout(() => {
          if (ipField.textContent === "Detecting...") {
            ipField.textContent = location.hostname || "localhost";
          }
        }, 2000);
      } catch (e) {
        ipField.textContent = location.hostname || "localhost";
      }
    })();

    // Simple client-side prompt hookup only
    document.getElementById('startBtn').addEventListener('click', function() {
  const role = document.getElementById('role').value;
  const method = document.getElementById('method').value;
  const name = document.getElementById('name').value.trim();

  // Basic input validation
  if (!name) {
    alert('Please enter your name.');
    return;
  }

  if (!role) {
    alert('Please select a role.');
    return;
  }

  if (!method) {
    alert('Please select a transfer method.');
    return;
  }

  // Only after validation succeeds
  const msg = `Hi ${name} üëã You chose ${role} using ${method}. Continue in desktop app to run full transfer.`;
  document.getElementById('statusMsg').textContent = msg;
});



async function detectLocalIP() {
  try {
    const res = await fetch('https://api.ipify.org?format=json');
    const data = await res.json();
    document.getElementById('userIP').textContent = data.ip;
  } catch {
    document.getElementById('userIP').textContent = 'localhost';
  }
}
window.onload = detectLocalIP;
</script>

</script>
</body>
</html>
